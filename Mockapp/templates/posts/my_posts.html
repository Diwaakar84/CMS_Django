{% extends "base.html" %}

{% block content %}

{% if user.is_authenticated %}
    <div class="button-container" style="text-align: right;">
        <a href="{% url 'new_post' %}" class="like-button">Add post</a>
    </div>
{% endif %}

<h1 class="category_title">Posts</h1>

<div class="post-container">
    {% for post in user_posts %}
        <div class="post">
            <div class="post-title">{{ post.title }}</div>
            <div class="post-description">{{ post.description }}</div>
            <div>Likes: {{ post.likes.count }}</div>

            <div class="post-actions">
                <a href="{% url 'post_detail' post.id %}" class="links">Show</a>
                
                <div class="like-button">
                    {% if post.likes.filter(user_id=user.id).exists %}
                        <form action="{% url 'unlike_post' post.id %}" method="post">
                            {% csrf_token %}
                            <button type="submit">Unlike</button>
                        </form>
                    {% else %}
                        <form action="{% url 'like_post' post.id %}" method="post">
                            {% csrf_token %}
                            <button type="submit">Like</button>
                        </form>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endfor %}
</div>

<script>
    document.querySelectorAll('.my-posts-nav').forEach(function(element) {
        element.classList.add('active');
    });
</script>

{% include 'posts/script.html' %}

{% end block %}